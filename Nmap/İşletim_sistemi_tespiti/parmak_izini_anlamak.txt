Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2025-11-10T23:28:30+03:00

====== parmak izini anlamak ======
Created Monday 10 November 2025

**GeniÅŸ ve DetaylÄ± Ã–zet â€“ â€œUnderstanding an Nmap Fingerprintâ€**

Bu metin, Nmapâ€™in (bir aÄŸ keÅŸif ve gÃ¼venlik tarama aracÄ±) **iÅŸletim sistemi (OS) tespitinde kullandÄ±ÄŸÄ± â€œfingerprintâ€ (parmak izi)** sistemini anlatÄ±r.  
AmaÃ§, Nmapâ€™in bir hedef sistemin aÄŸ cevaplarÄ±nÄ± analiz ederek onun iÅŸletim sistemi hakkÄ±nda tahminde bulunmasÄ±nÄ± saÄŸlamaktÄ±r.

---

### ğŸ”¹ 1. Nmap Fingerprint Nedir?
- **Fingerprint**, bir cihazÄ±n aÄŸ tepkilerinin Ã¶zetidir.  
  Nmap bu tepkileri analiz ederek hedef sistemin hangi iÅŸletim sistemine ait olabileceÄŸini Ã§Ä±karÄ±r.
- Her OSâ€™in TCP/IP protokol davranÄ±ÅŸlarÄ± farklÄ±dÄ±r, bu yÃ¼zden bu farklardan â€œimzalarâ€ oluÅŸturulur.
- Nmap, bu imzalarÄ± **nmap-os-db** adlÄ± veri tabanÄ±nda saklar.

---

### ğŸ”¹ 2. Fingerprint TÃ¼rleri
Nmap iki tÃ¼r fingerprint kullanÄ±r:

#### a) **Subject Fingerprint**
- Nmapâ€™in bir sistemi taradÄ±ktan sonra elde ettiÄŸi â€œhamâ€ test sonuÃ§larÄ±dÄ±r.
- EÄŸer Nmap bu veriyi veri tabanÄ±ndaki OSâ€™lerle tam eÅŸleÅŸtiremezse, bu fingerprintâ€™i yazdÄ±rÄ±r.  
  KullanÄ±cÄ± bunlarÄ± Nmap geliÅŸtirici ekibine gÃ¶nderebilir.
- Daha sade ve spesifiktir (yalnÄ±zca o taramaya Ã¶zgÃ¼dÃ¼r).

#### b) **Reference Fingerprint**
- Nmapâ€™in kendi veri tabanÄ±nda kayÄ±tlÄ±, Ã¶nceden bilinen iÅŸletim sistemi imzalarÄ±dÄ±r.
- GenelleÅŸtirilebilirler: aynÄ± OSâ€™in farklÄ± varyasyonlarÄ±nÄ± (Ã¶rneÄŸin farklÄ± donanÄ±m, sÃ¼rÃ¼cÃ¼ veya sÃ¼rÃ¼m) kapsayacak ÅŸekilde ayarlanabilir.
- OS adÄ±, sÄ±nÄ±fÄ± ve CPE bilgisi iÃ§erir.
- Subject fingerprintâ€™lerle eÅŸleÅŸtirme bu referanslara gÃ¶re yapÄ±lÄ±r.

---

### ğŸ”¹ 3. Subject Fingerprintâ€™in YapÄ±sÄ±
Bir subject fingerprint, karÄ±ÅŸÄ±k karakterlerden oluÅŸan kÄ±sa ve yoÄŸun bir formattadÄ±r, ama belirli bir yapÄ±ya sahiptir:

- Her satÄ±r, bir **test kategorisini** temsil eder.  
  Ã–rnek:  
  `SEQ` (TCP sÄ±ralama testleri),  
  `OPS` (TCP seÃ§enekleri),  
  `WIN` (pencere boyutu),  
  `T1â€“T7` (farklÄ± TCP sondalarÄ±),  
  `U1` (UDP testi),  
  `IE` (ICMP Echo testleri).

- Her testin iÃ§inde `<test>=<deÄŸer>` ÅŸeklinde Ã§iftler bulunur.
- `%` sembolÃ¼ testleri birbirinden ayÄ±rÄ±r.
- BoÅŸ deÄŸerler (â€œQ=â€) ya da eksik testler (â€œT2(R=N)â€) alÄ±nan yanÄ±t olmamasÄ± veya geÃ§ersiz sonuÃ§ anlamÄ±na gelir.
- Eksik testler, o sistemde ilgili yanÄ±tÄ±n alÄ±nmadÄ±ÄŸÄ±nÄ± veya testin atlandÄ±ÄŸÄ±nÄ± gÃ¶sterir.

---

### ğŸ”¹ 4. SCAN SatÄ±rÄ±
- `SCAN` satÄ±rÄ± taramanÄ±n genel bilgilerini iÃ§erir, OS hakkÄ±nda deÄŸil, taramanÄ±n **koÅŸullarÄ±nÄ±** gÃ¶sterir.
- Bu bilgiler, geliÅŸtiricilerin fingerprint gÃ¶nderimlerini yorumlamasÄ±na yardÄ±m eder.

Temel alanlar:
- **V:** Nmap sÃ¼rÃ¼mÃ¼  
- **D:** Tarama tarihi  
- **OT/CT:** KullanÄ±lan aÃ§Ä±k/kapalÄ± TCP portlarÄ±  
- **CU:** KapalÄ± UDP portu  
- **PV:** Hedef Ã¶zel IP alanÄ±nda mÄ± (RFC1918)?  
- **DS & DC:** Hedefe olan aÄŸ mesafesi ve hesaplama yÃ¶ntemi  
- **G:** SonuÃ§larÄ±n gÃ¶nderilmeye uygun olup olmadÄ±ÄŸÄ±  
- **TM:** Unix zaman damgasÄ±  
- **P:** Nmapâ€™in Ã§alÄ±ÅŸtÄ±ÄŸÄ± platform (Ã¶r. i686-pc-linux-gnu)

---

### ğŸ”¹ 5. Reference Fingerprintâ€™in YapÄ±sÄ±
Reference fingerprintâ€™ler subject fingerprintâ€™lere benzer, ama daha kapsamlÄ±dÄ±r:

Ek satÄ±rlar ÅŸunlardÄ±r:
- **Fingerprint:** OSâ€™in serbest biÃ§imli tanÄ±mÄ±.  
  Ã–rnek: â€œFingerprint Microsoft Windows XP Professional SP1â€
- **Class:** HiyerarÅŸik sÄ±nÄ±flandÄ±rma.  
  Format: `Vendor | OS Family | OS Generation | Device Type`
  - Vendor: Ãœretici (Apple, Cisco, Microsoft)
  - OS Family: ÃœrÃ¼n ailesi (Windows, Linux, IOS)
  - OS Generation: SÃ¼rÃ¼m veya jenerasyon (Ã¶r. 2.6.X, XP)
  - Device Type: Cihaz tÃ¼rÃ¼ (genel amaÃ§lÄ±, yazÄ±cÄ±, yÃ¶nlendirici vs.)
- **CPE:** Common Platform Enumeration karÅŸÄ±lÄ±ÄŸÄ±.  
  Standart formatta OS veya donanÄ±m tanÄ±mlar (`cpe:/o:apple:mac_os_x:10.2.8` gibi).

---

### ğŸ”¹ 6. Referans FormatÄ±ndaki DeÄŸiÅŸkenlik
- AynÄ± iÅŸletim sistemi, farklÄ± cihazlarda veya ayarlarda kÃ¼Ã§Ã¼k farklar gÃ¶sterebilir.
- Bu yÃ¼zden reference fingerprintâ€™ler, **genelleÅŸtirme** amacÄ±yla:
  - BazÄ± testleri Ã§Ä±karabilir (Ã¶rneÄŸin yanÄ±t alÄ±nmayan testler).
  - Veya **ifade (expression)** operatÃ¶rleri kullanabilir:
	- `|` â†’ â€œveyaâ€ (Ã¶rn. `W=F424|FAF0`)
	- `-` â†’ aralÄ±k (Ã¶rn. `SP=7-A`)
	- `>` ve `<` â†’ karÅŸÄ±laÅŸtÄ±rma operatÃ¶rleri.

Bu sayede tek bir fingerprint, bir OSâ€™in Ã§ok sayÄ±da varyasyonuyla eÅŸleÅŸebilir.

---

### ğŸ”¹ 7. OS TanÄ±mlamada Belirsizlikler
- AynÄ± fingerprint birkaÃ§ farklÄ± cihaza veya OS sÃ¼rÃ¼mÃ¼ne ait olabilir.  
  Sebepler:
  - AynÄ± Ã§ekirdek veya sÃ¼rÃ¼cÃ¼lerin farklÄ± cihazlarda kullanÄ±lmasÄ±.  
  - OEM cihazlarÄ±n yeniden markalanmasÄ±.
- Nmap bu durumda birkaÃ§ olasÄ± eÅŸleÅŸmeyi birden gÃ¶sterebilir, Ã¶rneÄŸin:
  > â€œCisco 1200 WAP, HP ProCurve switch veya Xerox printer olabilir.â€

---

### ğŸ”¹ 8. IPv6 Fingerprintâ€™leri
- IPv6 iÃ§in farklÄ± bir sÄ±nÄ±flandÄ±rma sistemi kullanÄ±lÄ±r.
- Burada reference fingerprint yoktur; Ã¶ÄŸrenme (training) algoritmasÄ± sonucunda **Ã¶zellik matrisleri** oluÅŸturulur.
- Subject fingerprint biÃ§imi IPv4â€™e benzer, ancak farklÄ± alanlar iÃ§erir:
  - **S1â€“S7:** AlÄ±nan her cevabÄ± temsil eder.
  - Her satÄ±rda:
	- `P`: Paketin iÃ§eriÄŸi (hex ve kÄ±saltÄ±lmÄ±ÅŸ biÃ§imde)
	- `ST`: GÃ¶nderildiÄŸi zaman
	- `RT`: AlÄ±ndÄ±ÄŸÄ± zaman
  - `EXTRA` satÄ±rÄ± ek bilgileri saklar (Ã¶rneÄŸin Flow Label).

- IPv6 fingerprintâ€™ler daha Ã§ok **makine Ã¶ÄŸrenimiyle sÄ±nÄ±flandÄ±rma** amacÄ±yla kullanÄ±lmaktadÄ±r.

---

### ğŸ”¹ 9. SonuÃ§ ve Ã–nemli Noktalar
- Nmapâ€™in fingerprint yapÄ±sÄ±, ham veriyi kÄ±sa, taÅŸÄ±nabilir ve kolay karÅŸÄ±laÅŸtÄ±rÄ±labilir biÃ§imde sunmak iÃ§in tasarlanmÄ±ÅŸtÄ±r.
- **Subject fingerprint** â†’ tarama sonucu  
  **Reference fingerprint** â†’ veri tabanÄ± karÅŸÄ±laÅŸtÄ±rmasÄ±  
- **SCAN satÄ±rÄ±** taramanÄ±n koÅŸullarÄ±nÄ±;  
  **SEQ, OPS, T1â€“T7, U1, IE** gibi bÃ¶lÃ¼mler ise sistemin aÄŸ Ã¶zelliklerini aÃ§Ä±klar.
- Reference fingerprintâ€™lerde:
  - **Fingerprint**: OS aÃ§Ä±klamasÄ±  
  - **Class**: YapÄ±landÄ±rÄ±lmÄ±ÅŸ sÄ±nÄ±flandÄ±rma  
  - **CPE**: StandartlaÅŸtÄ±rÄ±lmÄ±ÅŸ kimliklendirme
- IPv6 fingerprinting tamamen farklÄ± yÃ¶ntemlerle deÄŸerlendirilir, istatistiksel bir model kullanÄ±lÄ±r.

---

âœ… **Ã–zetle:**  
Nmap fingerprint sistemi, bir cihazÄ±n OSâ€™ini anlamak iÃ§in aÄŸ iletiÅŸim detaylarÄ±nÄ± imzaya dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r.  
Bu imzalar referans veritabanÄ±yla karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r.  
Subject fingerprint, tarama sonucu; reference fingerprint ise bilinen OS tanÄ±mÄ±dÄ±r.  
Her iki tÃ¼rÃ¼n yapÄ±sÄ± inceliklidir ama prensip aynÄ±dÄ±r: **aÄŸ davranÄ±ÅŸÄ±na gÃ¶re OS tahmini**.
