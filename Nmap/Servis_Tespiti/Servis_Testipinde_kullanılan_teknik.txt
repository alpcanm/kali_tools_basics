Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2025-11-10T22:30:19+03:00

====== Servis Testipinde kullanÄ±lan teknik ======
Created Monday 10 November 2025

**GENÄ°Å Ã–ZET â€“ NMAP SÃœRÃœM TESPÄ°TÄ° (Version Detection) TEKNÄ°ÄÄ°**

Bu metin, **Nmapâ€™in sÃ¼rÃ¼m tespiti (version detection)** sÃ¼recinin nasÄ±l Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ±, kullandÄ±ÄŸÄ± teknikleri ve bu tekniklerin nasÄ±l optimize edildiÄŸini aÃ§Ä±klar. AÅŸaÄŸÄ±da metnin geniÅŸ ve detaylÄ± bir Ã¶zeti yer almaktadÄ±r.

---

### 1. **Nmap SÃ¼rÃ¼m Tespiti Nedir?**
Nmapâ€™in sÃ¼rÃ¼m tespiti Ã¶zelliÄŸi, bir aÄŸ Ã¼zerinde aÃ§Ä±k olan portlarda hangi servisin ve hangi versiyonun Ã§alÄ±ÅŸtÄ±ÄŸÄ±nÄ± belirlemeye yarar. Bu iÅŸlem hem **hÄ±zlÄ±, Ã¶lÃ§eklenebilir** hem de **doÄŸru** olacak ÅŸekilde tasarlanmÄ±ÅŸtÄ±r.  
Nmap Ã¶nce bir **port taramasÄ±** yapar, ardÄ±ndan **aÃ§Ä±k (open)** veya **aÃ§Ä±k/filtreli (open|filtered)** portlarÄ± **hizmet tarama modÃ¼lÃ¼ne (service scanning module)** gÃ¶nderir.

---

### 2. **Port Tespiti ve BaÅŸlangÄ±Ã§ Kontrolleri**
- Nmap Ã¶nce, belirli portlarÄ±n tarama dÄ±ÅŸÄ± bÄ±rakÄ±lÄ±p bÄ±rakÄ±lmadÄ±ÄŸÄ±nÄ± (**Exclude** yÃ¶nergesi) kontrol eder.  
- EÄŸer TCP portu taranÄ±yorsa, Nmap portla baÄŸlantÄ± kurmayÄ± dener.  
  - BaÄŸlantÄ± baÅŸarÄ±lÄ± olursa portun durumu **open** olarak deÄŸiÅŸtirilir.  
- ArdÄ±ndan yaklaÅŸÄ±k **5 saniye bekler**. Bu bekleme sÃ¼resinde birÃ§ok sunucu (FTP, SSH, SMTP vb.) baÄŸlantÄ± sonrasÄ± kendini tanÄ±tan bir **karÅŸÄ±lama mesajÄ± (banner)** gÃ¶nderir.  
- Nmap bu aÅŸamada hiÃ§bir veri gÃ¶ndermediÄŸi iÃ§in buna **NULL probe** denir.  
  - Gelen yanÄ±t, **nmap-service-probes** dosyasÄ±ndaki 3000â€™e yakÄ±n imzayla karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r.  
  - EÄŸer tam bir eÅŸleÅŸme saÄŸlanÄ±rsa, sÃ¼rÃ¼m tespiti tamamlanÄ±r.
  - EÄŸer sadece â€œsoft matchâ€ (yani servis tÃ¼rÃ¼ biliniyor ama sÃ¼rÃ¼mÃ¼ bilinmiyor) elde edilirse, Nmap sadece o servis tÃ¼rÃ¼yle alakalÄ± testleri yapmaya devam eder.

---

### 3. **UDP Tarama Durumu**
- UDP taramalarÄ±nda doÄŸrudan **probe aÅŸamasÄ±ndan** baÅŸlanÄ±r Ã§Ã¼nkÃ¼ UDP baÄŸlantÄ± kurulmadan Ã§alÄ±ÅŸÄ±r.
- TCPâ€™de olduÄŸu gibi Ã§eÅŸitli probeâ€™lar gÃ¶nderilir, gelen yanÄ±tlar veri tabanÄ±ndaki imzalarla karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r.
- EÄŸer open|filtered durumundaki bir UDP portuna yanÄ±t gelirse, o portun durumu **open** olarak deÄŸiÅŸtirilir. BÃ¶ylece **sÃ¼rÃ¼m tespiti, UDP taramasÄ±nÄ± tamamlayÄ±cÄ±** bir yÃ¶ntem olur.

---

### 4. **Probe (Sorgu) MantÄ±ÄŸÄ±**
- Her probe, belirli bir port aralÄ±ÄŸÄ±nda etkili olacak ÅŸekilde tasarlanmÄ±ÅŸtÄ±r.  
  Ã–rnek: â€œGetRequestâ€ probeâ€™u web serverâ€™larÄ± tespit etmek iÃ§in tasarlanmÄ±ÅŸ olup 80, 8080 gibi portlarda Ã§alÄ±ÅŸÄ±r.
- Probeâ€™lar sÄ±rasÄ±yla portlara gÃ¶nderilir ve **dÃ¶nen yanÄ±tlar dÃ¼zenli ifadeler (regex)** ile karÅŸÄ±laÅŸtÄ±rÄ±lÄ±r.  
- ÃœÃ§ tip sonuÃ§ olur:
  1. **Tam eÅŸleÅŸme (full match)** â†’ Servis ve sÃ¼rÃ¼m tespit edilir, iÅŸlem biter.  
  2. **Soft match** â†’ Sadece servis tipi bilinir, tarama buna gÃ¶re devam eder.  
  3. **EÅŸleÅŸme yok** â†’ DiÄŸer probeâ€™lar denenir.

---

### 5. **Fallback (DÃ¼ÅŸme) ve Cheat (Hile) MekanizmasÄ±**
- BazÄ± durumlarda servisler geÃ§ yanÄ±t verir (Ã¶rneÄŸin SMTP sunucular DNS kontrolleri yaparken).  
- NULL probeâ€™un bekleme sÃ¼resi dolduktan sonra Nmap diÄŸer probeâ€™u (Ã¶rneÄŸin â€œHELP\r\nâ€) gÃ¶nderir. Ancak geÃ§ gelen yanÄ±t aslÄ±nda NULL probeâ€™un yanÄ±tÄ±dÄ±r.  
- Bu durumda Nmap â€œcheatâ€ yaparak gelen yanÄ±tÄ± yeniden NULL probe imzalarÄ±yla karÅŸÄ±laÅŸtÄ±rÄ±r.  
- Bu olay **â€œcheats and fallbacksâ€** olarak bilinir.  
- Benzer ÅŸekilde â€œfallbackâ€ yapÄ±sÄ±, bir probeâ€™un (Ã¶rneÄŸin HTTPOptions) baÅŸka bir probeâ€™un (Ã¶rneÄŸin GetRequest) imzalarÄ±yla eÅŸleÅŸmesine izin verir. Bu sayede **eksik yanÄ±t durumlarÄ±nda bile doÄŸru servis tespit edilir.**

---

### 6. **Performans Ä°yileÅŸtirmeleri ve HÄ±zlandÄ±rma Teknikleri**
Nmap, sÃ¼rÃ¼m tespitini hÄ±zlandÄ±rmak iÃ§in birkaÃ§ yÃ¶ntem uygular:
- **Genel (generic) probeâ€™lar:** â€œ\r\n\r\nâ€ veya â€œhelp\r\nâ€ gibi kÄ±sa sorgular birÃ§ok servis tipiyle eÅŸleÅŸebilir.  
- **Soft match** sonrasÄ±nda yalnÄ±zca ilgili probeâ€™lar denenir.  
- **Rarity (nadirlik)** deÄŸeri dÃ¼ÅŸÃ¼k olan probeâ€™lar Ã¶ncelikli denenir.
- KullanÄ±cÄ±lar --version-* seÃ§enekleri ile bu yoÄŸunluÄŸu kontrol edebilir:
  - `--version-light` â†’ Daha hÄ±zlÄ± ama yÃ¼zeysel tarama (intensity 2)
  - `--version-intensity <0â€“9>` â†’ Belirli bir yoÄŸunluk deÄŸeri (varsayÄ±lan 7)
  - `--version-all` â†’ TÃ¼m probeâ€™lar denenir (intensity 9)

---

### 7. **SSL ve Ã–zel Durumlar**
- Bir probe portun **SSL baÄŸlantÄ±lÄ±** olduÄŸunu belirlerse, Nmap OpenSSL kullanarak baÄŸlantÄ±yÄ± SSL Ã¼zerinden tekrar aÃ§ar ve taramayÄ± yeniden baÅŸlatÄ±r.  
- AyrÄ±ca Nmap **RPC (Remote Procedure Call)** ve **SMB** gibi Ã¶zel protokoller iÃ§in Ã¶zel tarama ve yorumlama modÃ¼lleri iÃ§erir.

---

### 8. **Yeni Servisler ve Fingerprint GÃ¶nderimi**
- EÄŸer Nmap bir yanÄ±t alÄ±r ancak servisi tanÄ±yamazsa, **fingerprint (parmak izi)** olarak Ã§Ä±ktÄ±yÄ± kullanÄ±cÄ±ya gÃ¶sterir.  
- KullanÄ±cÄ±lardan, bu bilinmeyen servislerin fingerprint'lerini Nmap geliÅŸtiricilerine gÃ¶ndermeleri istenir. Bu sayede Nmap veritabanÄ± sÃ¼rekli geniÅŸletilir.

---

### 9. **Probe SeÃ§imi ve Rarity DeÄŸeri**
- TÃ¼m probelarÄ±n bir rarity (nadirlik) deÄŸeri vardÄ±r (1â€“9 arasÄ±nda).
- TaramanÄ±n yoÄŸunluk seviyesi (intensity) arttÄ±kÃ§a, rarity deÄŸeri yÃ¼ksek probeâ€™lar da denenir.  
- Tarama ÅŸu ÅŸekilde ilerler:
  1. TCP iÃ§in daima **NULL probe** ilk denenir.  
  2. Portu muhtemelen tanÄ±yacak probeâ€™lar sÄ±rayla gÃ¶nderilir.  
  3. EÄŸer hÃ¢lÃ¢ eÅŸleÅŸme yoksa intensity deÄŸerine gÃ¶re diÄŸer probeâ€™lar denenir.  
  4. EÅŸleÅŸme bulunduÄŸunda iÅŸlem sonlanÄ±r.

---

### ğŸ”¹ **Ã–zetle AnlatÄ±lmak Ä°stenenler**
- Nmap sÃ¼rÃ¼m tespiti, aÃ§Ä±k portlardaki servislerin tÃ¼r ve sÃ¼rÃ¼mÃ¼nÃ¼ tespit etmek iÃ§in akÄ±llÄ±, Ã§ok aÅŸamalÄ± bir sistemdir.  
- NULL probe ve spesifik probeâ€™lar temel tarama yÃ¶ntemleridir.  
- Performans artÄ±rmak iÃ§in probe seÃ§imi rarity ve intensity deÄŸerlerine gÃ¶re optimize edilir.  
- SÃ¼reÃ§ TCP ve UDP portlarÄ± iÃ§in farklÄ± iÅŸler, SSL, RPC gibi Ã¶zel durumlara uyum saÄŸlar.  
- Nmap hatalÄ± veya yeni servisleri tanÄ±mlayamadÄ±ÄŸÄ±nda kullanÄ±cÄ±dan fingerprint gÃ¶ndermesini ister, bÃ¶ylece tarama kabiliyetini geliÅŸtirir.  
- â€œFallbackâ€ ve â€œcheatâ€ mekanizmasÄ±, yavaÅŸ ya da atipik yanÄ±t veren servislerin yine de doÄŸru ÅŸekilde tanÄ±nmasÄ±nÄ± saÄŸlar.

---

**SonuÃ§:**  
Nmapâ€™in sÃ¼rÃ¼m tespiti algoritmasÄ±, sadece servis adÄ±nÄ± deÄŸil aynÄ± zamanda sÃ¼rÃ¼mÃ¼nÃ¼, protokolÃ¼nÃ¼, hatta ardÄ±nda Ã§alÄ±ÅŸan yazÄ±lÄ±mÄ± da belirleyebilen bir sistemdir. Bu sistem; hÄ±z, doÄŸruluk ve adaptasyon arasÄ±nda dengeli bir yapÄ± sunar.
