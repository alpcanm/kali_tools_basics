Content-Type: text/x-zim-wiki
Wiki-Format: zim 0.6
Creation-Date: 2025-11-11T00:20:29+03:00

====== Script KullanÄ±mÄ± ======
Created Tuesday 11 November 2025

Bu metin, **Nmap Scripting Engine (NSE)**â€™nin nasÄ±l kullanÄ±ldÄ±ÄŸÄ±nÄ±, hangi tÃ¼r betikler (script) iÃ§erdiÄŸini ve bunlarÄ±n nasÄ±l seÃ§ilip Ã§alÄ±ÅŸtÄ±rÄ±lacaÄŸÄ±nÄ± anlatan Ã§ok kapsamlÄ± bir teknik aÃ§Ä±klamadÄ±r.  
AÅŸaÄŸÄ±da metnin geniÅŸ bir Ã¶zeti verilmiÅŸtir:  

---

## ğŸ”¹ Genel BakÄ±ÅŸ
**Nmap Scripting Engine (NSE)**, aÄŸ keÅŸfi, gÃ¼venlik testleri ve servis tespitinde kullanÄ±lan otomatik scriptâ€™lerdir. Nmapâ€™e gÃ¼Ã§lÃ¼ bir esneklik kazandÄ±rÄ±r. Ã‡ok karmaÅŸÄ±k bir yapÄ±ya sahip olmasÄ±na raÄŸmen, kullanÄ±mÄ± oldukÃ§a basittir.

### Temel kullanÄ±m:
- `-sC`: En yaygÄ±n (default) scriptâ€™leri Ã§alÄ±ÅŸtÄ±rÄ±r.  
- `--script`: Ä°stediÄŸiniz belirli scriptâ€™leri, kategorileri veya dizinleri Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.  
- `--script-args` / `--script-args-file`: Scriptâ€™lere Ã¶zel argÃ¼man/parametre gÃ¶ndermek iÃ§indir.  
- `--script-help`: Scriptâ€™ler hakkÄ±nda aÃ§Ä±klama gÃ¶sterir.  
- `--script-trace` ve `--script-updatedb`: Genellikle hata ayÄ±klama (debug) veya geliÅŸtirme amaÃ§lÄ±dÄ±r.  
- `-A`: â€œAggressive scanâ€ seÃ§eneÄŸi, otomatik olarak `-sC` taramasÄ±nÄ± da iÃ§inde barÄ±ndÄ±rÄ±r.

Script taramalarÄ± genellikle port taramalarÄ±yla birlikte yapÄ±lÄ±r. Ancak `-sn` (sadece host keÅŸfi) ile port taramasÄ± olmadan da Ã§alÄ±ÅŸtÄ±rÄ±labilir.

âš ï¸ **GÃ¼venlik uyarÄ±sÄ±:** NSE scriptâ€™leri â€œsandboxâ€ iÃ§inde Ã§alÄ±ÅŸmaz, yani zararlÄ± veya hatalÄ± scriptâ€™ler sisteminize zarar verebilir. Bu nedenle Ã¼Ã§Ã¼ncÃ¼ taraf scriptâ€™leri sadece gÃ¼venilir kaynaklardan alÄ±nmalÄ±dÄ±r.

---

## ğŸ”¹ Script Kategorileri
Her Nmap scriptâ€™i bir veya birden fazla **kategoriye** aittir. Bu kategoriler, scriptâ€™in amacÄ±nÄ± veya risk seviyesini belirtir.

| Kategori      | AÃ§Ä±klama                                                                         | Ã–rnek Scriptâ€™ler                     |
|---------------|----------------------------------------------------------------------------------|--------------------------------------|
| **auth**      | Kimlik doÄŸrulama bilgileriyle ilgilenir.                                         | ftp-anon, oracle-enum-users          |
| **broadcast** | Yerel aÄŸ Ã¼zerinden hedef arar.                                                   | Yeni hedefleri taramaya ekleyebilir. |
| **brute**     | Brute-force saldÄ±rÄ±larÄ± yapar (ÅŸifre deneme).                                    | http-brute, snmp-brute               |
| **default**   | `-sC` veya `-A` ile Ã§alÄ±ÅŸan temel script setidir.                                | ftp-anon, http-auth                  |
| **discovery** | AÄŸ yapÄ±sÄ± ve servis bilgisi keÅŸfeder.                                            | smb-enum-shares, html-title          |
| **dos**       | Servisleri Ã§Ã¶kertme (Denial of Service) testi yapar.                             |                                      |
| **exploit**   | AÃ§Ä±klarÄ± aktif ÅŸekilde kÃ¶tÃ¼ye kullanÄ±r.                                          | http-shellshock                      |
| **external**  | ÃœÃ§Ã¼ncÃ¼ taraf servislere (Ã¶rneÄŸin Whois) sorgu gÃ¶nderir.                          | whois-ip                             |
| **fuzzer**    | Servislere rastgele veya hatalÄ± veri gÃ¶nderip hata arar.                         | dns-fuzz                             |
| **intrusive** | AÄŸ yÃ¶neticileri tarafÄ±ndan saldÄ±rÄ± olarak algÄ±lanabilecek agresif testler yapar. | snmp-brute                           |
| **malware**   | KÃ¶tÃ¼ amaÃ§lÄ± yazÄ±lÄ±m gÃ¶stergelerini tespit eder.                                  | auth-spoof                           |
| **safe**      | GÃ¼venli, zararsÄ±z testlerdir.                                                    | ssh-hostkey, html-title              |
| **version**   | Servis sÃ¼rÃ¼mleriyle ilgilidir, `-sV` ile birlikte Ã§alÄ±ÅŸÄ±r.                       |                                      |
| **vuln**      | Bilinen gÃ¼venlik aÃ§Ä±klarÄ±nÄ± tespit eder.                                         | realvnc-auth-bypass                  |

### Default kategorisine script eklenme kriterleri:
Scriptâ€™in varsayÄ±lan (default) olarak Ã§alÄ±ÅŸabilmesi iÃ§in:
- **HÄ±zlÄ±** olmalÄ±, sistemi yavaÅŸlatmamalÄ±.  
- **YararlÄ±** ve anlamlÄ± bilgi Ã¼retmeli.  
- **Ã‡ok konuÅŸkan (verbose)** olmamalÄ±, sade Ã§Ä±ktÄ± vermeli.  
- **GÃ¼venilir** sonuÃ§lar vermeli, yanlÄ±ÅŸ pozitif az olmalÄ±.  
- **GÃ¼venli (non-intrusive)** olmalÄ±, sistem Ã§Ã¶kmesine yol aÃ§mamalÄ±.  
- **Gizlilik** ihlali yapmamalÄ±, Ã¼Ã§Ã¼ncÃ¼ taraflara bilgi sÄ±zdÄ±rmamalÄ±.

---

## ğŸ”¹ Script Tipleri ve Ã‡alÄ±ÅŸma AÅŸamalarÄ±

NSE scriptâ€™leri dÃ¶rt farklÄ± aÅŸamada Ã§alÄ±ÅŸabilir:

1. **Prerule scripts:**  
   Tarama baÅŸlamadan Ã¶nce Ã§alÄ±ÅŸÄ±r. AÄŸ genelinde hedef toplamak iÃ§in kullanÄ±lÄ±r (Ã¶rnek: `dns-zone-transfer`).

2. **Host scripts:**  
   Belirli bir hostâ€™un keÅŸfi tamamlandÄ±ktan sonra Ã§alÄ±ÅŸÄ±r.  
   Ã–rnek: `whois-ip`, `path-mtu`.

3. **Service scripts:**  
   Belirli portlarda veya hizmetlerde Ã§alÄ±ÅŸÄ±r. En yaygÄ±n script tÃ¼rÃ¼dÃ¼r.  
   Ã–rnek: HTTP sunucularÄ±na Ã¶zel scriptâ€™ler.

4. **Postrule scripts:**  
   TÃ¼m tarama bittikten sonra, sonuÃ§larÄ± Ã¶zetlemek veya iliÅŸkilendirmek iÃ§in Ã§alÄ±ÅŸÄ±r.  
   Ã–rnek: `ssh-hostkey`â€™nin postrule kÄ±smÄ±, aynÄ± anahtarlarÄ± kullanan hostâ€™larÄ± raporlar.

---

## ğŸ”¹ Komut SatÄ±rÄ± ArgÃ¼manlarÄ±

### 1. `-sC`
VarsayÄ±lan scriptâ€™leri (default category) Ã§alÄ±ÅŸtÄ±rÄ±r.  

### 2. `--script`
Belirli scriptâ€™leri, kategorileri veya dizinleri Ã§alÄ±ÅŸtÄ±rmak iÃ§in kullanÄ±lÄ±r.  
KarmaÅŸÄ±k seÃ§imler â€œand/or/notâ€ mantÄ±ÄŸÄ±yla yapÄ±labilir.  
Ã–rnekler:  
- `--script default,safe` â†’ Bu iki kategorideki tÃ¼m scriptâ€™leri Ã§alÄ±ÅŸtÄ±rÄ±r.  
- `--script "not intrusive"` â†’ GÃ¼venli olanlarÄ± Ã§alÄ±ÅŸtÄ±rÄ±r, intrusive olanlarÄ± hariÃ§ tutar.  
- `--script "http-*"` â†’ Ä°smi â€œhttp-â€ ile baÅŸlayan tÃ¼m scriptâ€™leri Ã§alÄ±ÅŸtÄ±rÄ±r.  

### 3. `--script-args`
Scriptâ€™lere parametre gÃ¶nderir.  
Ã–rnek:  
`--script-args broadcast-ping.timeout=300ms,creds.snmp=admin`

### 4. `--script-args-file`
ArgÃ¼manlarÄ± bir dosyadan okur.

### 5. `--script-help`
Belirli scriptâ€™lerin veya kategorilerin aÃ§Ä±klamasÄ±nÄ± gÃ¶sterir.  
Ã–rnek:  
`--script-help ssl-enum-ciphers`

### 6. `--script-trace`
Scriptâ€™lerin aÄŸ Ã¼zerindeki iletiÅŸimini detaylÄ± ÅŸekilde gÃ¶sterir (debug amaÃ§lÄ±).  

### 7. `--script-updatedb`
Script veritabanÄ±nÄ± (`scripts/script.db`) gÃ¼nceller. Yeni script eklerseniz bunu Ã§alÄ±ÅŸtÄ±rmanÄ±z gerekir.

---

## ğŸ”¹ Script ArgÃ¼manlarÄ±nÄ±n KullanÄ±mÄ±
Scriptâ€™lere dinamik parametreler verilebilir.  
YapÄ±, Lua sÃ¶z dizimine benzer.  

Ã–rnek:  
```
--script-args 'user=foo,pass=",{}=bar",paths={/admin,/cgi-bin}'
```
Bu ifade ÅŸu veri tablosunu oluÅŸturur:
```
user = "foo"
pass = ",{}=bar"
paths = {"/admin", "/cgi-bin"}
```
ArgÃ¼manlar genellikle script adÄ±yla baÅŸlar (Ã¶rnek: `xmpp-info.server_name`), bÃ¶ylece karÄ±ÅŸmaz.

---

## ğŸ”¹ Uygulama Ã–rnekleri
| Komut                                                                    | AÃ§Ä±klama                                                              |
|--------------------------------------------------------------------------|-----------------------------------------------------------------------|
| `nmap -sC example.com`                                                   | VarsayÄ±lan script setiyle tarama                                      |
| `nmap -sn -sC example.com`                                               | Port taramasÄ± yapmadan sadece host scriptâ€™leri                        |
| `nmap -Pn -sn -sC example.com`                                           | Host keÅŸfi ve port taramasÄ± olmadan Ã§alÄ±ÅŸma                           |
| `nmap --script smb-os-discovery --script-trace example.com`              | Belirli bir scriptâ€™i trace ile Ã§alÄ±ÅŸtÄ±rma                             |
| `nmap --script snmp-sysdescr --script-args creds.snmp=admin example.com` | Scriptâ€™e Ã¶zel argÃ¼manla Ã§alÄ±ÅŸtÄ±rma                                    |
| `nmap --script mycustomscripts,safe example.com`                         | Kendi dizininizdeki ve â€œsafeâ€ kategorideki tÃ¼m scriptâ€™leri Ã§alÄ±ÅŸtÄ±rma |

---

## ğŸ”¹ Ã–zetle
- NSE, Nmapâ€™in en esnek ve gÃ¼Ã§lÃ¼ bileÅŸenidir.  
- Scriptâ€™ler otomatize gÃ¼venlik testleri, keÅŸif iÅŸlemleri ve zafiyet analizleri yapar.  
- Kategoriler, gÃ¼venlik ve kullanÄ±m amacÄ±na gÃ¶re sÄ±nÄ±flandÄ±rÄ±lmÄ±ÅŸtÄ±r.  
- Parametreler (args) ile script davranÄ±ÅŸÄ± Ã¶zelleÅŸtirilebilir.  
- BazÄ± scriptâ€™ler gÃ¼venli, bazÄ±larÄ± ise saldÄ±rgan veya tehlikelidir.  
- Bu yÃ¼zden **yetkisiz sistemlerde script taramasÄ± yapmak sakÄ±ncalÄ±dÄ±r**.

---

KÄ±sacasÄ± bu metin, Nmapâ€™in **NSE (Nmap Scripting Engine)** Ã¶zelliÄŸini kavratmak, betiklerin mantÄ±ÄŸÄ±nÄ±, tÃ¼rlerini ve doÄŸru kullanÄ±m ÅŸeklini Ã¶ÄŸretmek iÃ§in hazÄ±rlanmÄ±ÅŸ ayrÄ±ntÄ±lÄ± bir kullanÄ±m rehberidir.
